---
name: refactoring
description: リファクタリング作業を行う際に読み込むべき規約
---

# リファクタリング規約

リファクタリング作業を行う際は、この規約に従うこと。

## 原則

**修正量を減らすために「あるべきコードの姿」を歪めてはならない**

リファクタリングの目的は、コードを正しい状態にすることである。修正箇所が多くなることを理由に、中途半端な状態や互換性のための回避策を残すことは絶対に禁止する。修正の手間を惜しまず、技術的負債ゼロを維持すること。

## 禁止される判断パターン

- 「修正箇所が多いから」という理由で本来不要な互換性レイヤーを追加する
- 「既存コードを壊さないため」という理由で古い構造やAPIを残す
- 「後で直す」という前提で問題を先送りにする
- 問題を解決するためのリファクタなのに、その問題を部分的に残す

## 具体例

これらは一例であり、同様の判断はすべて禁止：

- 関数を別ファイルに移動する際、元の場所から再エクスポートして既存のインポートを維持する → **全インポート箇所を修正すべき**
- 変数名を変更する際、古い名前のエイリアスを残す → **全使用箇所を修正すべき**
- 型定義を変更する際、古い型との互換性のためにunion型にする → **全使用箇所を新しい型に移行すべき**

---

# 既存の問題への対応

## 原則

**問題を見つけたら修正する。「既存だから」「今回の修正範囲外だから」は理由にならない。**

## 禁止事項

- **「既存のコードだから」という理由で問題を放置することの禁止**: 既存のデバッグログ、コメント規約違反、コードスメルを見つけた場合、今回の修正の一環として修正すること
- **「修正対象外」という概念の禁止**: コードを触る際は、周辺コードも含めて品質基準を満たす責任がある
- **問題の先送りの禁止**: 「後で直す」「別のPRで対応する」として問題を残すことは禁止

## 必須事項

- 作業中に発見した問題（デバッグログ、コメント規約違反、型安全性の問題など）は、その場で修正する
- 修正範囲が大きくなる場合でも、問題を放置せずに修正する
- 既存のコードに問題があることを発見した場合、それを報告するだけでなく修正する義務がある
